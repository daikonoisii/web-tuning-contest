**Lighthouse パフォーマンスチューニングコンテストシステム**

### **概要**
このシステムは、Lighthouse を活用した Web パフォーマンスチューニングのコンテストを円滑に運営するためのものです。各参加者が Web アプリケーションを開発・最適化し、システムが自動で評価を行い、ランキングを更新します。

### **コンテストの流れ**
1. **ローカル開発**  
   - 各参加者は、自分の PC 上で Web ページの開発を行います。
   
2. **GitLab へのプッシュ & コンテナデプロイ**  
   - 参加者が GitLab にプッシュすると、ブランチ名に応じたコンテナにイメージが送信されます。
   - コンテナは受け取ったイメージをビルドし、ビルドの成否に関わらず起動します。
   - ビルドエラー発生時には Slack に通知を送る。
   
3. **コンテナの起動 & 完了フラグの送信**  
   - ビルドが完了すると、コンテナは Lighthouse サーバーに完了フラグを送信します。
   
4. **Lighthouse サーバーの処理**  
   - Lighthouse サーバーはランキングページを管理し、コンテナからのフラグを処理します。
   - フラグを受信すると、該当コンテナが公開する Web ページに `lighthouse-flows-generator` でアクセスし、パフォーマンスを評価します。
   - 評価結果を HTML レポートとして保存します。
   - 独自のスコアリングアルゴリズムを用いてスコアを計算します。
   - Lighthouse の結果とは別に、エラーログを管理する UI（GitLab の Job ログや Sentry 連携）を導入。
   - 各スコア（Performance, Accessibility, Best Practices, SEO, PWA）の個別ランキングを作成。
   - 主要指標（LCP, TBT, CLS など）の変動を時系列で保存し、可視化。
   - 参加者ごとのスコア履歴を保存し、過去のスコア変動を可視化。
   - 
   - ランキングページを更新し、最新のスコアを反映します。
   - 生成された HTML レポートを Slack に送信し、参加者が確認できるようにします。

### **インフラ構成**
- **コンテナ管理システム**  
  - 参加者ごとにコンテナを自動生成。
  - GitLab から送信されたイメージを各コンテナに割り当て。
  - 一定時間アクセスがないコンテナは停止し、リソースを節約。
  - 参加者ごとのコンテナを完全に固定せず、ビルドのたびに動的に割り当てる。ただし、一人当たりのコンテナ数は 1 つに限定する。

- **GitLab 連携**  
  - 各 Git プッシュが適切なコンテナの更新とビルドをトリガー。
  - ビルドエラーが発生した場合、Slack にエラーログを通知。

- **参加者コンテナ**  
  - 受け取ったイメージをビルド。
  - ビルドした Web ページをデプロイ。
  - ビルド完了後に Lighthouse サーバーへ通知。

- **Lighthouse サーバー**  
  - ランキングページの公開。
  - `lighthouse-flows-generator` によるパフォーマンス評価。
  - 各スコア（Performance, Accessibility, Best Practices, SEO, PWA）を個別ランキング化。
  - Lighthouse の結果を基にスコアを計算。
  - 主要指標（LCP, TBT, CLS）の時系列データを保存・可視化。
  - ランキングページの更新。
  - 生成レポートを Slack へ送信。

### **使用技術**
- **コンテナ化**: Docker を利用し、各参加者の環境を分離。
- **CI/CD**: GitLab による自動ビルド・デプロイ。
- **パフォーマンス解析**: Lighthouse & `lighthouse-flows-generator`。
- **通知・共有**: Slack 連携で結果を共有。


## 将来的な拡張 (ver2)
バージョン 2 で以下の機能を追加予定:

- Lighthouse レポートの拡張
 - Web Vitals や Core Web Vitals などの評価モードを追加。
- AI によるアドバイス
 - 過去データを元に改善すべきポイントを AI が提案。
- 他のメトリクスとの連携
